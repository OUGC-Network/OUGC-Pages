<?xml version="1.0" encoding="UTF-8"?>
<!-- MyBB PluginLibrary XML-Export :: 2024-09-11T21:11:59+00:00 -->
<array>
    <element>
        <key>name</key>
        <value>Warning List</value>
    </element>
    <element>
        <key>description</key>
        <value>Displays a list of warnings.</value>
    </element>
    <element>
        <key>url</key>
        <value>warnlist</value>
    </element>
    <element>
        <key>allowedGroups</key>
        <value>-1</value>
    </element>
    <element>
        <key>php</key>
        <value>1</value>
    </element>
    <element>
        <key>wol</key>
        <value>0</value>
    </element>
    <element>
        <key>visible</key>
        <value>1</value>
    </element>
    <element>
        <key>wrapper</key>
        <value>0</value>
    </element>
    <element>
        <key>init</key>
        <value>4</value>
    </element>
    <element>
        <key>template</key>
        <value><![CDATA[<?php

$lang->load('modcp');

require_once MYBB_ROOT . 'inc/class_parser.php';

$parser = new postParser;

$templates->cache('ougcpages_warnings_user, ougcpages_warnings_empty, ougcpages_warnings');

isset($templates->cache['ougcpages_warnings_user']) or $templates->cache['ougcpages_warnings_user'] = '<tr>
<td class="{$alternativeBackground}">{$profileLink}</td>
<td class="{$alternativeBackground}" align="center">{$warningPoints}</td>
<td class="{$alternativeBackground}" align="center">{$warningLevel}</td>
<td class="{$alternativeBackground}" align="center">{$lastActive}</td>
</tr>';
isset($templates->cache['ougcpages_warnings_empty']) or $templates->cache['ougcpages_warnings_empty'] = '<tr>
	<td class="trow1" align="center" colspan="4">There are currently no warned users to display.</td>
</tr>';
isset($templates->cache['ougcpages_warnings']) or $templates->cache['ougcpages_warnings'] = '<html>
<head>
<title>{$mybb->settings[\'bbname\']} - {$pageData[\'name\']}</title>
{$headerinclude}
</head>
<body>
	{$header}
	<table width="100%" border="0" align="center">
		<tr>
			<td valign="top">
				<table border="0" cellspacing="{$theme[\'borderwidth\']}" cellpadding="{$theme[\'tablespace\']}" class="tborder">
					<tr>
						<td class="thead" colspan="4">
						    <strong>Warnings</strong>
						</td>
					</tr>
					<tr>
						<td class="tcat" width="25%"><span class="smalltext"><strong>User</strong></span></td>
						<td class="tcat" align="center" width="30%"><span class="smalltext"><strong>Warning Points</strong></span></td>
						<td class="tcat" align="center" width="25%"><span class="smalltext"><strong>Warning Level</strong></span></td>
						<td class="tcat" align="center" width="20%"><span class="smalltext"><strong>Last Active</strong></span></td>
					</tr>
					{$warnedUsers}
				</table>
				{$multipage}
			</td>
		</tr>
	</table>
	{$footer}
</body>
</html>';

$categoryName = htmlspecialchars_uni($categoryData['name']);

if (!empty($categoryData['breadcrumb'])) {
    add_breadcrumb($categoryName, \ougc\Pages\Core\categoryGetLink($categoryID));
}

$pageName = htmlspecialchars_uni($pageData['name']);

add_breadcrumb($pageName, \ougc\Pages\Core\pageGetLink($pageID));

if ($mybb->settings['threadsperpage'] < 1) {
    $mybb->settings['threadsperpage'] = 20;
}

$perPage = (int)$mybb->settings['threadsperpage'];

$currentPage = $mybb->get_input('pagination', \MyBB::INPUT_INT);

$dbQuery = $db->simple_select('users', 'COUNT(uid) AS totalUsers', "warningpoints!=0");

$totalUsers = $db->fetch_field($dbQuery, 'totalUsers');

$totalPages = $totalUsers / $perPage;

$totalPages = ceil($totalPages);

if ($currentPage > $totalPages || $currentPage <= 0) {
    $currentPage = 1;
}

if ($currentPage) {
    $start = ($currentPage - 1) * $perPage;
} else {
    $start = 0;

    $currentPage = 1;
}

$multipage = multipage($totalUsers, $perPage, $currentPage, '?PLACE_HOLDER');

$multipage = str_replace(
    ['page=', '?PLACE_HOLDER'],
    ['pagination=', \ougc\Pages\Core\pageGetLink($pageID)],
    $multipage
);

switch ($mybb->get_input('sort')) {
    case 'username':
        $sort = 'username';
        break;
    default:
        $sort = 'uid';
        break;
}

switch ($mybb->get_input('order')) {
    case 'asc':
        $order = 'ASC';
        break;
    default:
        $order = 'DESC';
        break;
}

$dbQuery = $db->simple_select(
    'users',
    'uid, username, usergroup, displaygroup, warningpoints, lastactive',
    "warningpoints!=0",
    ['order_by' => $sort, 'order_dir' => $order, 'limit' => $perPage, 'limit_start' => $start]
);

$alternativeBackground = alt_trow(true);

$warnedUsers = '';

while ($userData = $db->fetch_array($dbQuery)) {
    $userName = htmlspecialchars_uni($userData['username']);

    $userNameFormatted = format_name($userName, $userData['usergroup'], $userData['displaygroup']);

    $profileLink = build_profile_link($userNameFormatted, $userData['uid']);

    $warningPoints = my_number_format($userData['warningpoints']);

    $warningLevel = ($warningPoints * 2);

    $lastActive = my_date('relative', $userData['lastactive']);

    $warnedUsers = eval($templates->render('ougcpages_warnings_user'));

    $alternativeBackground = alt_trow();
}

if (!$warnedUsers) {
    $warnedUsers = eval($templates->render('ougcpages_warnings_empty'));
}

$page = eval($templates->render('ougcpages_warnings'));

output_page($page);

exit;]]></value>
    </element>
    <element>
        <key>versioncode</key>
        <value type="INT">1833</value>
    </element>
</array>
        <!-- End of file. -->